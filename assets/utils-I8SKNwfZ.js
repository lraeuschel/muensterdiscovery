const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/symbolLayerUtils-C8n1vx4a.js","assets/index-BSeLMfXB.js","assets/index-DvAGVfN9.css"])))=>i.map(i=>d[i]);
import{eP as b,aH as s,hZ as y,h_ as h,h$ as w,i0 as k,i1 as g,_ as L}from"./index-BSeLMfXB.js";import{S as v,u as z}from"./cimSymbolUtils-B1ybRHn7.js";new b(1e3);new s([128,128,128]);function I(n){if(n==null||!("symbolLayers"in n)||n.symbolLayers==null)return!1;switch(n.type){case"point-3d":return n.symbolLayers.some(r=>r.type==="object");case"line-3d":return n.symbolLayers.some(r=>r.type==="path");case"polygon-3d":return n.symbolLayers.some(r=>r.type==="object"||r.type==="extrude");default:return!1}}function J(n){return n.resource?.href??""}function M(n,r){if(!n)return null;let o=null;return y(n)?o=_(n):h(n)&&(o=n.type==="cim"?z(n):n.color?new s(n.color):null),o?u(o,r):null}function _(n){const r=n.symbolLayers;if(!r)return null;let o=null;return r.forEach(l=>{l.type==="object"&&l.resource?.href||(o=l.type==="water"?l.color:l.material?l.material.color:null)}),o?new s(o):null}function u(n,r){if(r==null||n==null)return n;const o=n.toRgba();return o[3]=o[3]*r,new s(o)}function S(n,r,o){const l=n.symbolLayers;if(!l)return;const t=(e,c=!1)=>{let i=r??e??null;return o?.override!=null&&(!i&&c&&(i=new s([255,255,255])),i&&(i.a=o.override)),u(i,o?.add)};l.forEach(e=>{if(e.type==="water")return void(e.color=u(e.color,o?.add));const c=e.material!=null?e.material.color:null,i=t(c,e.type==="icon"&&e.resource?.href!=null);e.material==null?e.material=new w({color:i}):e.material.color=i,"outline"in e&&e.outline?.color&&o?.add!=null&&(e.outline.color=u(e.outline.color,o.add)),"marker"in e&&e.marker!=null&&(e.marker.color=t(e.marker.color))})}function x(n,r,o){r=r??n.color,o?.override!=null&&r&&(r.a=o.override),r&&(n.color=u(r,o?.add)),"outline"in n&&n.outline?.color&&(n.outline.color=u(n.outline.color,o?.add))}function N(n,r,o){n&&(r||o!=null)&&(r&&(r=new s(r)),y(n)?S(n,r,o):h(n)&&x(n,r,o))}async function j(n,r){const o=n.symbolLayers;o&&await k(o,async l=>E(l,r))}async function E(n,r){switch(n.type){case"extrude":R(n,r);break;case"icon":case"line":case"text":$(n,r);break;case"path":P(n,r);break;case"object":await O(n,r)}}function $(n,r){const o=m(r);o!=null&&(n.size=o)}function m(n){for(const r of n)if(typeof r=="number")return r;return null}function R(n,r){const o=r[2];typeof o=="number"&&(n.size=o)}async function O(n,r){const{resourceSize:o,symbolSize:l}=await A(n),t=p(r,o,l);t!=null&&(n.width=f(r[0],l[0],o[0],t),n.depth=f(r[1],l[1],o[1],t),n.height=f(r[2],l[2],o[2],t))}function P(n,r){const o=p(r,g,[n.width,void 0,n.height]);o!=null&&(n.width=f(r[0],n.width,1,o),n.height=f(r[2],n.height,1,o))}function p(n,r,o){for(let l=0;l<3;l++){const t=n[l];switch(t){case"symbol-value":{const e=o[l];return e!=null?e/r[l]:1}case"proportional":break;default:if(t&&r[l])return t/r[l]}}return null}async function A(n){const{computeObjectLayerResourceSize:r}=await L(()=>import("./symbolLayerUtils-C8n1vx4a.js"),__vite__mapDeps([0,1,2])),o=await r(n,10),{width:l,height:t,depth:e}=n,c=[l,e,t];let i=1;for(let a=0;a<3;a++){const d=c[a];if(d!=null){i=d/o[a];break}}for(let a=0;a<3;a++)c[a]==null&&(c[a]=o[a]*i);return{resourceSize:o,symbolSize:c}}function f(n,r,o,l){switch(n){case"proportional":return o*l;case"symbol-value":return r??o;default:return n}}function D(n,r){const o=m(r);if(o!=null)switch(n.type){case"simple-marker":n.size=o;break;case"picture-marker":{const l=n.width/n.height;l>1?(n.width=o,n.height=o*l):(n.width=o*l,n.height=o);break}case"simple-line":n.width=o;break;case"text":n.font.size=o}}async function T(n,r){if(n&&r)return y(n)?j(n,r):void(h(n)&&D(n,r))}function U(n,r,o){if(n&&r!=null){if(y(n)){const l=n.symbolLayers;l&&l.forEach(t=>{if(t.type==="object")switch(o){case"tilt":t.tilt=(t.tilt??0)+r;break;case"roll":t.roll=(t.roll??0)+r;break;default:t.heading=(t.heading??0)+r}t.type==="icon"&&(t.angle+=r)})}else if(h(n))switch(n.type){case"simple-marker":case"picture-marker":case"text":n.angle+=r;break;case"cim":v(n,r,!0)}}}function V(n){return n!=null&&n.type==="polygon-3d"&&n.symbolLayers.some(r=>r.type==="extrude")}export{V as A,N as L,T as M,U as N,M as b,J as d,I as h};
